\section[Chained Correlated Gaussian Processes]{Chained Correlated Gaussian Processes: Transforming Gaussian Processes into Likelihood Parameters}

\subsection{Mathematical Framework}


\begin{frame}{Chanied Correlated GP (ChdGP)}
	
	\begin{columns}[T] % Top alignment
		\begin{column}{0.5\textwidth}	
			\textbf{Independent Process}
			\begin{equation*}
				u_{q}(\mathbf{x}) \sim \mathcal{GP}(0, k_{q}(\mathbf{x}, \mathbf{x}'))
			\end{equation*}
			
			\textbf{Latent Process}
			\begin{equation*}
					f_{d,j}(\mathbf{x}) = \sum_{q=1}^Q a_{d,j,q} u_{q}(\mathbf{x})
			\end{equation*}
			
			\textbf{Likelihood}
			\begin{equation*}
				p(\mathbf{y} \mid \mathbf{f}) = \prod_{d=1}^D p(y_{d}\mid \theta_{d, 1}, \cdots, \theta_{d, J_d})
			\end{equation*}
			
	
				\begin{itemize}
					\item $\theta_{d,j} = g_{d, j}(f_{d, j})$ is a likelihood parameter. 
					\item  $g_{d, j}(\cdot)$ is a deterministic function.
				\end{itemize}
	
			
		\end{column}
		
		\begin{column}{0.5\textwidth}
			\justifying
			\setlength\figurewidth{0.44\textwidth} 
			\setlength\figureheight{0.35\textwidth}
			\input{chp_lmc/figures/chd_graph}	
		\end{column}
		
	\end{columns}
\end{frame}

\begin{frame}{Variational Inference, ELBO and Predictive Distribution}
	We can extent our variational inference, providing the following ELBO:
	
\begin{equation*}
	\begin{split}
	\mathcal{L} &= \sum_{d=1}^D \sum_{n=1}^{N} \mathbb{E}_{q(f_{d,1,n}), \cdots, q(f_{d,J_d,n})} 
	\left\{ \log p\left( y_{d,n} \mid f_{d,1,n}, \cdots, f_{d,J_d,n} \right) \right\} \\
	&- \sum_{q=1}^Q \text{KL}\left\{ q(\mathbf{u}_q) \parallel p(\mathbf{u}_q) \right\}
	\end{split}
\end{equation*}

The approximated posterior over test points is given by:

\begin{equation*}
	p(\mathbf{f}_* \mid \mathbf{y}) \approx q(\mathbf{f}_*) = \int p(\mathbf{f}_* \mid \mathbf{u}) q(\mathbf{u}) d\mathbf{u}
\end{equation*}

And the predictive distribution for a new output $\mathbf{y}_*$:
\begin{equation*}
	p(\mathbf{y}_* \mid \mathbf{y}) \approx \int p(\mathbf{y}_* \mid \mathbf{f}_*) q(\mathbf{f}_*) \, d\mathbf{f}_*,
\end{equation*}

The expectation values can be approximated via Monte Carlo methods.
	
\end{frame}

\begin{frame}{Model Setup}
	We again make use of squared exponential kernel to construct the covariance function and Adam + NG framework to train the models.
		
	\begin{block}{\textbf{Gaussian Likelihood}}
		\begin{equation*}
			p(\mathbf{y} \mid \mathbf{f}) = \prod_{d=1}^{D} \mathcal{N}\left(y_{d}\mid g_{d,1}(f_{d,1}), g_{d,2}(f_{d,2}) \right)
		\end{equation*}
		In this formulation, \(g_{d,1}(\cdot) = \cdot\), while \(g_{d,2}(\cdot) = \ln(\exp(\cdot) + 1)\). We call this model Chd Normal.
	\end{block} 
	
	\begin{block}{\textbf{Gamma Likelihood}}
		\begin{equation*}
		p(\mathbf{y} \mid \mathbf{f}) = \prod_{d=1}^{D} \mathcal{G}amma\left( y_{d} \mid g_{d,1}(f_{d,1}), g_{d,2}(f_{d,2}) \right)
		\end{equation*}
		
		In this formulation \(g_{d,1}(\cdot) = g_{d,2}(\cdot) = \ln(\exp(\cdot) + 1)\). We call this model Chd Gamma.
	\end{block}
		
\end{frame}

\subsection{Results and Discussions}

\begin{frame}{Tuning Q for Chd Normal}
	\begin{figure}[htbp]
		\centering
		\setlength\figurewidth{0.5\columnwidth} 
		\setlength\figureheight{0.3\columnwidth}
		\subfloat[CRPS]{\input{chp_chd/figures/CRPS_chd_normal}}
		\subfloat[MSE]{\input{chp_chd/figures/MSE_chd_normal}}\\
		\vspace{-0.2cm}
		\subfloat[MSLL]{\input{chp_chd/figures/MSLL_chd_normal}}
		\subfloat[NLPD]{\input{chp_chd/figures/NLPD_chd_normal}}\\
		\vspace{-0.5cm}
		\caption{Performance metrics for ChdGP Normal model as a function of the number of independent GPs Q. We select $Q = 15$ as the optimal value.}
	\end{figure}
\end{frame}

\subsection{Performance Analysis}
\begin{frame}{ChdGP Normal vs LMCGP}
	\begin{figure}[htbp]
		\centering
		\setlength\figurewidth{0.53\columnwidth}
		\setlength\figureheight{0.5\columnwidth}
		
		\subfloat[NLPD]{\input{chp_chd/figures/NLPD_peformance_chdnormal}}
		\hfill
		\subfloat[MSLL]{\input{chp_chd/figures/MSLL_peformance_chdnormal}}
		
		\caption{Bar plots comparing the performance of LMCGP, and ChdGP Normal models for different \(H\) values.}
	\end{figure}
\end{frame}

\begin{frame}{ChdGP Normal Forecasting}
	\justifying
	\begin{figure}[htbp]
		\setlength\figurewidth{0.52\columnwidth} 
		\setlength\figureheight{0.29\columnwidth}
		
		\subfloat[$T.$]{\input{chp_chd/figures/chd_normal_forecasting_SALVAJINA}}\hfill
		\subfloat[$A.$]{\input{chp_chd/figures/chd_normal_forecasting_AMANI}}\\[-0.5cm]
		\subfloat[$I.$]{\input{chp_chd/figures/chd_normal_forecasting_SAN LORENZO}}\hfill
		\subfloat[$O.$]{\input{chp_chd/figures/chd_normal_forecasting_ESMERALDA}}\\[-0.4cm]
		
		\caption{Test data for four reservoirs in one day ahead ChdGP Normal model prediction ($H=1$). Blue shaded areas represent the $95\%$ centered confidence interval for the model's prediction.}
	\end{figure}
\end{frame}

\begin{frame}{Tuning Q for Chd Gamma}
	\begin{figure}[htbp]
		\centering
		\setlength\figurewidth{\columnwidth} 
		\setlength\figureheight{0.55\columnwidth}
		\input{chp_chd/figures/NLPD_chd_gamma}
		\caption{NLPD metric for ChdGP Gamma models as a function of the number of independent GPs. We select $Q = 26$ as the optimal value.}
	\end{figure}
\end{frame}

\subsection{Performance Analysis}

\begin{frame}{ChdnGP Gamma vs ChdGP Normal}
	\begin{figure}[htbp]
		\centering
		\setlength\figurewidth{\columnwidth} 
		\setlength\figureheight{0.55\columnwidth}
		\input{chp_chd/figures/NLPD_peformance_chdgamma}
		\caption{Comparison of NLPD metric across different prediction horizons for the ChdGP Normal, and ChdGP Gamma models.}
	\end{figure}
	
\end{frame}

\begin{frame}{ChdGP Gamma Forecasting}
	\centering
	\begin{figure}[htbp]
		\tiny
		\setlength\figurewidth{0.52\columnwidth} 
		\setlength\figureheight{0.30\columnwidth}
		
		\subfloat[$T.$]{\input{chp_chd/figures/chd_gamma_forecasting_SALVAJINA}}\hfill
		\subfloat[$A.$]{\input{chp_chd/figures/chd_gamma_forecasting_AMANI}}\\[-0.5cm]
		\subfloat[$I.$]{\input{chp_chd/figures/chd_gamma_forecasting_SAN LORENZO}}\hfill
		\subfloat[$O.$]{\input{chp_chd/figures/chd_gamma_forecasting_ESMERALDA}}\\[-0.4cm]
		
		\caption{Test data for four reservoirs in one day ahead ChdGP Normal model prediction. Blue shaded areas represent the $95\%$ centered confidence interval for the model's prediction.}
	\end{figure}
\end{frame}

\begin{frame}{To Conclude}
		
		\begin{block}{}
			The ChdGP model generalizes all previously developed GP-based models, enhancing expressiveness by modeling likelihood parameters and enabling the handling of natural output restrictions.	
		\end{block}
		
		\begin{block}{}
			The ChdGP Normal model outperformed the LMCGP model across all forecasting horizons, primarily due to its ability to adaptively vary data noise over the input space, providing a more refined capture of the underlying data structure.
		\end{block}
		
		\begin{block}{}
			The ChdGP with Gamma likelihood ensured non-negative predictions. The tuning process revealed a significant improvement in model stability as the number of independent GPs ($Q$) increased, suggesting superior data modeling capabilities.
		\end{block}
		
		\begin{block}{}
			The Gamma likelihood configuration outperformed the Gaussian likelihood across all evaluated horizons by avoiding the allocation of predictive distribution mass to negative values and utilizing an asymmetric distribution to more effectively handle peak outliers.
		\end{block}
		
\end{frame}

